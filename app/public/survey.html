<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
        <title>Event Saver</title>
        <script
        src="https://code.jquery.com/jquery-3.2.1.js"
        integrity="sha256-DZAnKJ/6XZ9si04Hgrsxu/8s717jcIzLy3oi35EouyE="
        crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta/css/bootstrap.min.css" integrity="sha384-/Y6pD6FV/Vv2HJnA6t+vslU6fwYXjCFtcEpHbNJ0lyAFsXTsjBbfaDjzALeQsN6M" crossorigin="anonymous">        
</head>
<body>
    <div class='container'>
        <div class='row'>
            <div class='panel panel-default'>
                <div class='panel-heading'>
                    <h3>Train Arrival</h3>
                </div>
                <div class="panel-body">
                    <h3>
                        <u>Survey Questions</u>
                    </h3>
                    <div class='panel panel-default'>
                        <h4>About You</h4>
                        <div class="panel-body">
                            <form id="form">
                                <p>Name (required)</p>
                                <input type="text" id="name">
    
                                <p>Link to Photo Image (Required)</p>
                                <input type="text" id="photo">
    
                                <div class="question">
                                    <p>Question 1</p>
                                    <p>I often think of murder.</p>
                                    <select data-placeholder="" class="chosen-select" id="q1">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 2</p>
                                    <p>If someone told you their dog pooped on your lawn how badly would you want to murder them?</p>
                                    <select data-placeholder="" class="chosen-select" id="q2">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
    
                                </div>
    
                                <div class="question">
                                    <p>Question 3</p>
                                    <p>I worry I've wet the bed?</p>
                                    <select data-placeholder="" class="chosen-select" id="q3">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 4</p>
                                    <p>You are walking home, late at night. There is nobody about. You see a homeless man, lying drunk in a pool of his own urine. How badly do you want to kick him?</p>
                                    <select data-placeholder="" class="chosen-select" id="q4">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 5</p>
                                    <p>I kick dogs often</p>
                                    <select data-placeholder="" class="chosen-select" id="q5">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 6</p>
                                    <p>I like to watch things burn</p>
                                    <select data-placeholder="" class="chosen-select" id="q6">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 7</p>
                                    <p>I often want to lash out with violence</p>
                                    <select data-placeholder="" class="chosen-select" id="q7">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 8</p>
                                    <p>You think of yourself as a serial killer</p>
                                    <select data-placeholder="" class="chosen-select" id="q8">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 9</p>
                                    <p>Have you not Murdered</p>
                                    <select data-placeholder="" class="chosen-select" id="q9">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>
                                </div>
    
                                <div class="question">
                                    <p>Question 10</p>
                                    <p>I like walks on the beach</p>
                                    <select data-placeholder="" class="chosen-select" id="q10">
                                        <option value=""></option>
                                        <option value="1">1 (Strongly Disagree)</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5 (Strongly Agree)</option>
                                    </select>    
                                </div>
                                
                                <input type="submit" id="submit">
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    
    <div id="resultsModal" class="modal fade" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h2 class="modal-title">
                        <strong>Best Match</strong>
                    </h2>
                </div>
                <div class="modal-body">
                    <h2 id="matchName"></h2>
                    <img id="matchImg" src="https://media.licdn.com/mpr/mpr/shrinknp_400_400/p/6/005/064/1bd/3435aa3.jpg" alt="">
      
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    
    <script>
        $("#form").submit(function(e){
            e.preventDefault();
            let me = {
                name: $("#name").val().trim(),
                photo: $("#photo").val().trim(),
                scores: [5,1,3,4,5,3,2,3,4,1]
            };

            $("#name").val("");
            $("#photo").val("");

            // for(var i=1; i<11; i++){
            //     me.scores.push($(`#q${i}`).val().trim())
            //     $(`#q${i}`).val("");
            // }

            let bestfriend = {
                name: "",
                photo: "",
                difference: 0
            };

            // console.log(me)

            $.ajax({
			      url: `/api/friends`,
			      method: 'GET'
                }).done(function(res) {
                    for (var i=0; i<res.friends.length; i++) {
                        var score1 = 0;
                        var score2 = 0;
                        
                        for (var j=0; j<res.friends[i].scores.length; j++){
                             score1 += res.friends[i].scores[j]
                             score2 += me.scores[j]
                        };

                        var difference = Math.abs(score1-score2)

                        // console.log(difference)
                        if (difference<bestfriend.difference) {
                            bestfriend.name = res.friends[i].name;
                            bestfriend.photo = res.friends[i].photo;
                            bestfriend.difference = difference
                        }
                    }

                    //display best friend in the modal

                    //currently sending back a 500 server issue.  Need to fix
                    $.post( "/api/friends", `${me}` );

                })
        });
    </script>
</body>
</html>

